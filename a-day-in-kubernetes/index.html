<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>A day in Kubernetes - Stefano Boriero</title><meta name=Description content="You can consider this is a declaration of intent, but really is just a simple way to get the ball rolling on this project of mine. Like a more verbose Hello, World!"><meta property="og:title" content="A day in Kubernetes"><meta property="og:description" content="You can consider this is a declaration of intent, but really is just a simple way to get the ball rolling on this project of mine. Like a more verbose Hello, World!"><meta property="og:type" content="article"><meta property="og:url" content="https://stefanoboriero.github.io/a-day-in-kubernetes/"><meta property="og:image" content="https://stefanoboriero.github.io/images/favicon.ico"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-11T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-14T00:56:42+01:00"><meta property="og:site_name" content="Stefano Boriero"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://stefanoboriero.github.io/images/favicon.ico"><meta name=twitter:title content="A day in Kubernetes"><meta name=twitter:description content="You can consider this is a declaration of intent, but really is just a simple way to get the ball rolling on this project of mine. Like a more verbose Hello, World!"><meta name=application-name content="Stefano Boriero"><meta name=apple-mobile-web-app-title content="Stefano Boriero"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://stefanoboriero.github.io/a-day-in-kubernetes/><link rel=prev href=https://stefanoboriero.github.io/intro/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"A day in Kubernetes","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/stefanoboriero.github.io\/a-day-in-kubernetes\/"},"image":["https:\/\/stefanoboriero.github.io\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"kubernetes, hackday","wordcount":1386,"url":"https:\/\/stefanoboriero.github.io\/a-day-in-kubernetes\/","datePublished":"2022-12-11T00:00:00+00:00","dateModified":"2023-02-14T00:56:42+01:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/stefanoboriero.github.io\/images\/avatar.png"},"author":{"@type":"Person","name":"Stefano Boriero"},"description":"You can consider this is a declaration of intent, but really is just a simple way to get the ball rolling on this project of mine. Like a more verbose Hello, World!"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Stefano Boriero">Stefano Boriero</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/StefanoBoriero title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Stefano Boriero">Stefano Boriero</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/StefanoBoriero title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">A day in Kubernetes</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Stefano Boriero</a></span>&nbsp;<span class=post-category>included in <a href=/categories/learning/><i class="far fa-folder fa-fw" aria-hidden=true></i>learning</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-12-11>2022-12-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1386 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;7 minutes&nbsp;<span id=/a-day-in-kubernetes/ class=leancloud_visitors data-flag-title="A day in Kubernetes">
<i class="far fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#what-is-kubernetes>What is Kubernetes?</a><ul><li><a href=#pods>Pods</a></li><li><a href=#services>Services</a></li></ul></li><li><a href=#running-kubernetes-locally>Running Kubernetes locally</a><ul><li><a href=#my-application>My application</a></li><li><a href=#creating-my-first-deployment>Creating my first deployment</a></li><li><a href=#creating-my-first-service>Creating my first Service</a></li><li><a href=#accessing-the-application>Accessing the application</a></li></ul></li><li><a href=#bonus-part-scraping-my-pods-with-prometheus>Bonus part: scraping my Pods with Prometheus</a></li><li><a href=#running-out-of-disk-space>Running out of disk space</a></li><li><a href=#conclusion>Conclusion</a><ul><li><a href=#follow-up>Follow up</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>Recentely I was asked if I had any experience in Kubernetes: well, long story short, I don&rsquo;t :)</p><p>But it poked my interest a bit, so I decided to give it a try and see what I can learn about it in a short time. It&rsquo;s a rainy Sunday, so it seems like a perfect day to concentrate and take a deep dive on the topic. Ideally I&rsquo;d want to be able to deploy a couple of services in Kubernetes and have them communicate with each other.</p><h2 id=what-is-kubernetes>What is Kubernetes?</h2><p>According to their <a href=https://kubernetes.io/docs/concepts/overview/ target=_blank rel="noopener noreffer">official documentation</a></p><blockquote><p>Kubernetes is a portable, extensible, open source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation.</p></blockquote><p>That&rsquo;s a nice definition, but I believe I need to dig deeper to really understanding. Having a look at the documentation Kubernetes seems humongous! Let&rsquo;s try to focus on the bare minimum we&rsquo;ll need to deploy an application: let&rsquo;s start by having a look at what a Pod is</p><h3 id=pods>Pods</h3><p>Quoting from <a href=https://kubernetes.io/docs/concepts/overview/ target=_blank rel="noopener noreffer">https://kubernetes.io/docs/concepts/overview/</a></p><blockquote><p>Pods are the smallest deployable units of computing that you can create and manage in Kubernetes. A Pod (as in a pod of whales or pea pod) is a group of one or more containers, with shared storage and network resources, and a specification for how to run the containers.</p></blockquote><p>For me, coming from the ECS world, this really resembles what a Task is. Okay, so what we&rsquo;ll probably do is we&rsquo;re going to deploy instances of our application as Pods. But there must be a way to group multiple Pods/instances of our app under a common umbrella.</p><h3 id=services>Services</h3><p>Quoting from <a href=https://kubernetes.io/docs/concepts/services-networking/service/ target=_blank rel="noopener noreffer">https://kubernetes.io/docs/concepts/services-networking/service/</a></p><blockquote><p>An abstract way to expose an application running on a set of Pods as a network service. With Kubernetes you don&rsquo;t need to modify your application to use an unfamiliar service discovery mechanism. Kubernetes gives Pods their own IP addresses and a single DNS name for a set of Pods, and can load-balance across them.</p></blockquote><p>Nice, this is what I was expecting to find! It even comes with Load Balancing out of the box, sweet.</p><p>So we&rsquo;ll want to deploy an application as one or more Pods, and expose it via a Service. I think we have enough to start and finish in one day. So let&rsquo;s get to work</p><h2 id=running-kubernetes-locally>Running Kubernetes locally</h2><p>Well, one sure thing about Kubernetes is that it&rsquo;s BIG. It was not designed to run locally on a consumer machine, but luckily there are well supported flavours of Kubernetes that can be run locally, like <a href=https://minikube.sigs.k8s.io/docs/ target=_blank rel="noopener noreffer">minikube</a> for instance. So let&rsquo;s follow the installation <a href=https://minikube.sigs.k8s.io/docs/start/ target=_blank rel="noopener noreffer">instructions</a> and try to run it with <code>minikube start</code> command. And I got the first error, not off to a sparkling start :sweat-smile:</p><blockquote><p>Exiting due to <code>RSRC_DOCKER_STORAGE</code>: Docker is out of disk space! (/var is at 99% of capacity). You can pass &lsquo;&ndash;force&rsquo; to skip this check.</p></blockquote><p>If I were running on Windows or MacOS, I could give the linux VM that is spinned up by Docker more memory from the Docker Desktop configuration: unfortunately I&rsquo;m running on Linux, so this error just means I have some cleanup to do. After removing stale docker resources witht the <code>docker system prune</code> command, I was finally able to start minikube 🎉!</p><p>With the command <code>minikube dashboard</code> I&rsquo;m able to see a nice dashboard displaying the cluster current state: this is going to be very useful to exepriment a bit.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-day-in-kubernetes/minikube-dashboard.png data-srcset="/images/a-day-in-kubernetes/minikube-dashboard.png, /images/a-day-in-kubernetes/minikube-dashboard.png 1.5x, /images/a-day-in-kubernetes/minikube-dashboard.png 2x" data-sizes=auto alt=/images/a-day-in-kubernetes/minikube-dashboard.png title="Minikube dashboard"></p><h3 id=my-application>My application</h3><p>SpringBoot is a framework I grew familiar with, so I chose it to create <a href=https://github.com/StefanoBoriero/kubernetes-demo target=_blank rel="noopener noreffer">this sample Hello, world! application</a> that exposes a few simple endpoints returning static text. Have a look if you fancy, but I want to focus more on deploying this to Kubernetes rather than the app itself.</p><h3 id=creating-my-first-deployment>Creating my first deployment</h3><p>Now I have a running local Kubernetes cluster, and a Docker image: time to deploy!
Kubernetes takes a declarative approach to deployments. This means that you can focus on declaring the desired state rather than imperatively enumerate all the instructions yourself.</p><p>I created the following deployement descriptor:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>stefanoboriero/kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>This means that I want 2 Pods (<code>replicas: 2</code>) and each Pod is just one container running the <code>stefanoboriero/kubernetes-demo</code> image, with a named port opened at 8080. Pretty simple. Let&rsquo;s apply this with the command <code>minikube kubectl -- apply -f kubernetes/deployment.yml</code> and see what happens.</p><blockquote><p>deployment.apps/kubernetes-demo-deployment created</p></blockquote><p>Sweet! If I have a look at the minikube dashboard, I can see both the deployment and the 2 Pods running. Great, but now how can I make requests to the application?</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-day-in-kubernetes/deployment.png data-srcset="/images/a-day-in-kubernetes/deployment.png, /images/a-day-in-kubernetes/deployment.png 1.5x, /images/a-day-in-kubernetes/deployment.png 2x" data-sizes=auto alt=/images/a-day-in-kubernetes/deployment.png title=Deployment></p><h3 id=creating-my-first-service>Creating my first Service</h3><p>Services are what I&rsquo;m looking for. There are <a href=https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types target=_blank rel="noopener noreffer">different service types</a> but the most appropriate for my local experiment is NodePort type.</p><p>I created the following Service definition:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes-demo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodePort</span><span class=p>:</span><span class=w> </span><span class=m>30003</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>clusterIP</span><span class=p>:</span><span class=w> </span><span class=m>10.100.184.41</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>The <code>selector</code> object defines what Pods are part of this service: it&rsquo;s handy that I don&rsquo;t have to specify their Ips or anything, so even if I add or remove Pods when the app scales up or down, the selector will just pick them up. I specified both <code>port</code> and <code>targetPort</code> because, remember, this acts also as a LoadBalancer: so the <code>port</code> field is the port where the LoadBalancer is listening, and <code>targetPort</code> is the port of the Pod behind it. In this case they&rsquo;re both 8080 and I could have omitted the <code>targetPort</code> because the same value is used by default, but I wanted to be as explicit as possible. <code>nodePort</code> is the port on the Kubernetes node that is accessible from outside the cluster, I hardcoded it for predictability and replicability of the example. Finally, <code>clusterIP</code> is the IP that is reacheable only from inside the Kubernetes cluster.</p><p>Let&rsquo;s run <code>minikube kubectl -- apply -f kubernetes/service.yml</code> and apply this</p><blockquote><p>service/kubernetes-demo-service created</p></blockquote><p>And I can see the service in the minikube dashboard as well!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-day-in-kubernetes/service.png data-srcset="/images/a-day-in-kubernetes/service.png, /images/a-day-in-kubernetes/service.png 1.5x, /images/a-day-in-kubernetes/service.png 2x" data-sizes=auto alt=/images/a-day-in-kubernetes/service.png title=Services></p><h3 id=accessing-the-application>Accessing the application</h3><p>My application is now accessible at http://192.168.49.2:30003/hello!</p><p>There are a few other endpoints just to test out few different ways to connect between services in the cluster:</p><ul><li>http://192.168.49.2:30003/forwardUsingExternalisedService will get the response contacting a second service using its externalised ip.</li><li>http://192.168.49.2:30003/forwardUsingClusterIp will get the response contacting a second service using its internal clusterIP.</li><li>http://192.168.49.2:30003/forwardUsingServiceName will get the response contacting a second service using its service name, letting Kubernetes resolve the actual service ip.</li></ul><p>If I&rsquo;m running another instance of my application oustide Kubernetes, then only the first will work.</p><p>That&rsquo;s great! I achieved what I was looking forward to.</p><h2 id=bonus-part-scraping-my-pods-with-prometheus>Bonus part: scraping my Pods with Prometheus</h2><p>Knowing how important Observability is even in early stages of development, I additionally tried to deploy a Prometheus instance that would scrape my Pods following <a href=https://devopscube.com/setup-prometheus-monitoring-on-kubernetes/ target=_blank rel="noopener noreffer">these instructions</a>. That gave me the possibility of seeing few other bits of Kubernetes in action, like ClusterRoles, ServiceAccounts and ConfigMap. And there you can see my Pods being scraped!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/a-day-in-kubernetes/prometheus.png data-srcset="/images/a-day-in-kubernetes/prometheus.png, /images/a-day-in-kubernetes/prometheus.png 1.5x, /images/a-day-in-kubernetes/prometheus.png 2x" data-sizes=auto alt=/images/a-day-in-kubernetes/prometheus.png title=Prometheus></p><h2 id=running-out-of-disk-space>Running out of disk space</h2><p>After that, my laptop ran out of disk space :sweat-smile: so I started getting all sorts of errors like</p><blockquote><p>E1212 02:57:43.099164 426734 root.go:80] failed to log command start to audit: unable to write to audit log: write /home/stefano/.minikube/logs/audit.json: no space left on device</p></blockquote><p>So it was time to turn off the laptop :)</p><h2 id=conclusion>Conclusion</h2><p>I liked it! I think Kubernetes does a good job at easing the deployment of containerised services with its declarative approach. I also like the way the networking is taken care of, being able to resolve service names via the internal DNS makes it possible to randomise IP address at will. And it has so many more features that I didn&rsquo;t had the chanche to explore!</p><h3 id=follow-up>Follow up</h3><p>When I&rsquo;ll have some more time I&rsquo;d like to take a look at how services can be horizontally scaled, and how the LoadBalancing can be configured. Ingress is another crucial component I didn&rsquo;t have the time to play with.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-02-14&nbsp;<a class=git-hash href=https://github.com/StefanoBoriero/StefanoBoriero.github.io/commit/3af43adbd4181ccc1e4669e92626403fda36c219 target=_blank title="commit by stefano.boriero@gmail.com(stefano.boriero@gmail.com) 3af43adbd4181ccc1e4669e92626403fda36c219: Change Hugo theme">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>3af43ad</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/a-day-in-kubernetes/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://stefanoboriero.github.io/a-day-in-kubernetes/ data-title="A day in Kubernetes" data-hashtags=kubernetes,hackday><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://stefanoboriero.github.io/a-day-in-kubernetes/ data-hashtag=kubernetes><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://stefanoboriero.github.io/a-day-in-kubernetes/ data-title="A day in Kubernetes"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://stefanoboriero.github.io/a-day-in-kubernetes/ data-title="A day in Kubernetes"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://stefanoboriero.github.io/a-day-in-kubernetes/ data-title="A day in Kubernetes"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/kubernetes/>kubernetes</a>,&nbsp;<a href=/tags/hackday/>hackday</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/intro/ class=prev rel=prev title="Why does this webiste exist?"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Why does this webiste exist?</a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Stefano Boriero</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/valine@1.5.0/dist/Valine.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{valine:{appId:"QGzwQXOqs5JOhN4RGPOkR2mR-MdYXbMMI",appKey:"WBmoGyJtbqUswvfLh6L8iEBr",avatar:"mp",el:"#valine",emojiCDN:"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/",emojiMaps:{100:"1f4af.png",alien:"1f47d.png",anger:"1f4a2.png",angry:"1f620.png",anguished:"1f627.png",astonished:"1f632.png",black_heart:"1f5a4.png",blue_heart:"1f499.png",blush:"1f60a.png",bomb:"1f4a3.png",boom:"1f4a5.png",broken_heart:"1f494.png",brown_heart:"1f90e.png",clown_face:"1f921.png",cold_face:"1f976.png",cold_sweat:"1f630.png",confounded:"1f616.png",confused:"1f615.png",cry:"1f622.png",crying_cat_face:"1f63f.png",cupid:"1f498.png",dash:"1f4a8.png",disappointed:"1f61e.png",disappointed_relieved:"1f625.png",dizzy:"1f4ab.png",dizzy_face:"1f635.png",drooling_face:"1f924.png",exploding_head:"1f92f.png",expressionless:"1f611.png",face_vomiting:"1f92e.png",face_with_cowboy_hat:"1f920.png",face_with_hand_over_mouth:"1f92d.png",face_with_head_bandage:"1f915.png",face_with_monocle:"1f9d0.png",face_with_raised_eyebrow:"1f928.png",face_with_rolling_eyes:"1f644.png",face_with_symbols_on_mouth:"1f92c.png",face_with_thermometer:"1f912.png",fearful:"1f628.png",flushed:"1f633.png",frowning:"1f626.png",ghost:"1f47b.png",gift_heart:"1f49d.png",green_heart:"1f49a.png",grimacing:"1f62c.png",grin:"1f601.png",grinning:"1f600.png",hankey:"1f4a9.png",hear_no_evil:"1f649.png",heart:"2764-fe0f.png",heart_decoration:"1f49f.png",heart_eyes:"1f60d.png",heart_eyes_cat:"1f63b.png",heartbeat:"1f493.png",heartpulse:"1f497.png",heavy_heart_exclamation_mark_ornament:"2763-fe0f.png",hole:"1f573-fe0f.png",hot_face:"1f975.png",hugging_face:"1f917.png",hushed:"1f62f.png",imp:"1f47f.png",innocent:"1f607.png",japanese_goblin:"1f47a.png",japanese_ogre:"1f479.png",joy:"1f602.png",joy_cat:"1f639.png",kiss:"1f48b.png",kissing:"1f617.png",kissing_cat:"1f63d.png",kissing_closed_eyes:"1f61a.png",kissing_heart:"1f618.png",kissing_smiling_eyes:"1f619.png",laughing:"1f606.png",left_speech_bubble:"1f5e8-fe0f.png",love_letter:"1f48c.png",lying_face:"1f925.png",mask:"1f637.png",money_mouth_face:"1f911.png",nauseated_face:"1f922.png",nerd_face:"1f913.png",neutral_face:"1f610.png",no_mouth:"1f636.png",open_mouth:"1f62e.png",orange_heart:"1f9e1.png",partying_face:"1f973.png",pensive:"1f614.png",persevere:"1f623.png",pleading_face:"1f97a.png",pouting_cat:"1f63e.png",purple_heart:"1f49c.png",rage:"1f621.png",relaxed:"263a-fe0f.png",relieved:"1f60c.png",revolving_hearts:"1f49e.png",right_anger_bubble:"1f5ef-fe0f.png",robot_face:"1f916.png",rolling_on_the_floor_laughing:"1f923.png",scream:"1f631.png",scream_cat:"1f640.png",see_no_evil:"1f648.png",shushing_face:"1f92b.png",skull:"1f480.png",skull_and_crossbones:"2620-fe0f.png",sleeping:"1f634.png",sleepy:"1f62a.png",slightly_frowning_face:"1f641.png",slightly_smiling_face:"1f642.png",smile:"1f604.png",smile_cat:"1f638.png",smiley:"1f603.png",smiley_cat:"1f63a.png",smiling_face_with_3_hearts:"1f970.png",smiling_imp:"1f608.png",smirk:"1f60f.png",smirk_cat:"1f63c.png",sneezing_face:"1f927.png",sob:"1f62d.png",space_invader:"1f47e.png",sparkling_heart:"1f496.png",speak_no_evil:"1f64a.png",speech_balloon:"1f4ac.png","star-struck":"1f929.png",stuck_out_tongue:"1f61b.png",stuck_out_tongue_closed_eyes:"1f61d.png",stuck_out_tongue_winking_eye:"1f61c.png",sunglasses:"1f60e.png",sweat:"1f613.png",sweat_drops:"1f4a6.png",sweat_smile:"1f605.png",thinking_face:"1f914.png",thought_balloon:"1f4ad.png",tired_face:"1f62b.png",triumph:"1f624.png",two_hearts:"1f495.png",unamused:"1f612.png",upside_down_face:"1f643.png",weary:"1f629.png",white_frowning_face:"2639-fe0f.png",white_heart:"1f90d.png",wink:"1f609.png",woozy_face:"1f974.png",worried:"1f61f.png",yawning_face:"1f971.png",yellow_heart:"1f49b.png",yum:"1f60b.png",zany_face:"1f92a.png",zipper_mouth_face:"1f910.png",zzz:"1f4a4.png"},enableQQ:!1,highlight:!0,lang:"en",pageSize:10,placeholder:"Your comment ...",recordIP:!0,serverURLs:"https://leancloud.hugoloveit.com",visitor:!0}},search:{algoliaAppID:"PASDMWALPK",algoliaIndex:"index.en",algoliaSearchKey:"b42948e51daaa93df92381c8e2ac0f93",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3XT5D2HP5W",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-3XT5D2HP5W" async></script></body></html>